import{g as b}from"./get-prompt-c4dadeb6.js";import{g}from"./get-user-config-095b2c2d.js";import"./storage-0924aca3.js";import"./default-user-config-22e12d79.js";const w=async()=>{if(!window.location.search.includes("ref=glasp"))return;let o=0;const n=setInterval(r,1500);async function r(){var d;o++,o>=5&&clearInterval(n);const e=await b();if(!e||e=="")return;await f(e),clearInterval(n);const i=await g(),l=Object.values(i.followupPrompts).filter(t=>t!=="");if(l.length===0)return;await new Promise(t=>setTimeout(t,2e3));const u=l.length<=2?2:3,m=document.querySelector("form .grow");m?m.innerHTML=`
    <div style="display: grid;grid-template-columns: repeat(${u}, 1fr);width: 100%;gap: 8px;">
      ${l.map(t=>p(t)).join("")}
    </div>`:(d=document.querySelector("form"))==null||d.children[0].insertAdjacentHTML("afterbegin",`<div style="display: grid;grid-template-columns: repeat(${u}, 1fr);width: 100%;gap: 8px; margin-bottom:12px;">
        ${l.map(t=>p(t)).join("")}
      </div>`),document.querySelectorAll(".glasp_ext_next_prompts").forEach(t=>{t.addEventListener("click",s=>{s.target&&"innerText"in s.target&&f(s.target.innerText,300)}),t.addEventListener("mouseover",()=>{const s=t;s.style.backgroundColor="#ececf1"}),t.addEventListener("mouseout",()=>{const s=t;s.style.backgroundColor="#FFFFFF"})})}},p=o=>`
    <div class="glasp_ext_next_prompts" style="padding: 8px 16px; border-radius: 0.25rem; border: 1px solid rgba(0,0,0,.1); font-size: 14px;cursor: pointer;color: #40414F;line-height: 1.35em;background-color: #FFFFFF;user-select: none;" title="${o}">
        <div style="display: -webkit-box; -webkit-line-clamp: 1; -webkit-box-orient: vertical; overflow: hidden; white-space: break-spaces; text-overflow: ellipsis;">${o}</div>
    </div>`;async function f(o,a=1e3){try{const n="main form .ProseMirror",r="main form button",e=document.querySelector(n);e&&(e.innerHTML=`<p>${o}</p>`,e.focus(),e.dispatchEvent(new Event("input",{bubbles:!0}))),await new Promise(l=>setTimeout(l,a));const i=document.querySelectorAll(r),c=i[i.length-1]||document.querySelector('button[aria-label="Send prompt"]')||document.querySelector('button[data-testid="send-button"]');c.disabled=!1,c.click()}catch{y(o)}}async function y(o){try{const a="main form textarea:last-child",n="main form button",r=document.querySelector(a)?document.querySelector(a):document.getElementsByTagName("textarea")[0];r&&(r.style.height=r.scrollHeight+"px",r.value=o,r.focus(),r.dispatchEvent(new Event("input",{bubbles:!0}))),await new Promise(c=>setTimeout(c,500));const e=document.querySelectorAll(n),i=e[e.length-1];i.disabled=!1,i.click()}catch{return}}w();
